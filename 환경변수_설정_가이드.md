# 환경변수 설정 가이드

## 개요

이 프로젝트는 프론트엔드(Next.js)와 백엔드(FastAPI)로 구성되어 있으며, 각각 다른 환경변수 설정이 필요합니다.

## 프론트엔드 환경변수

### 위치
- 파일: `apps/web/.env.local` 또는 `apps/web/.env`
- Next.js는 `.env.local` 파일을 우선적으로 읽습니다.

### 필수 환경변수

```bash
# Backend API URL
# 개발 환경: http://localhost:8000
# 프로덕션: 실제 API 서버 URL (예: https://api.example.com)
NEXT_PUBLIC_API_URL=http://localhost:8000
```

### 중요 사항

1. **NEXT_PUBLIC_ 접두사 필수**: Next.js에서 클라이언트 사이드에서 접근 가능한 환경변수는 반드시 `NEXT_PUBLIC_` 접두사가 있어야 합니다.

2. **환경변수 적용**: 환경변수를 변경한 후에는 Next.js 개발 서버를 재시작해야 합니다.

3. **프로덕션 배포**: 프로덕션 환경에서는 배포 플랫폼(Vercel, Netlify 등)의 환경변수 설정에서 `NEXT_PUBLIC_API_URL`을 설정해야 합니다.

## 백엔드 환경변수

### 위치
- 파일: 프로젝트 루트의 `.env` 파일
- 또는 Docker Compose의 `environment` 섹션

### 필수 환경변수

```bash
# Database
DATABASE_URL=postgresql://user:password@localhost:5432/analyst_awards

# Redis
REDIS_URL=redis://localhost:6379/0
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2

# AI API Keys
OPENAI_API_KEY=your_openai_key_here
ANTHROPIC_API_KEY=your_anthropic_key_here
GOOGLE_API_KEY=your_google_key_here
PERPLEXITY_API_KEY=your_perplexity_key_here

# CORS (쉼표로 구분된 여러 origin 허용)
CORS_ORIGINS=http://localhost:3000,http://localhost:5000

# Storage
STORAGE_PATH=/app/storage
```

## Docker Compose 환경변수

`docker-compose.yml` 파일에서 환경변수를 설정할 수 있습니다:

```yaml
services:
  api:
    environment:
      DATABASE_URL: postgresql://user:password@postgres:5432/analyst_awards
      REDIS_URL: redis://redis:6379/0
      # ... 기타 환경변수
```

## 환경별 설정

### 개발 환경

```bash
# 프론트엔드
NEXT_PUBLIC_API_URL=http://localhost:8000

# 백엔드
DATABASE_URL=postgresql://user:password@localhost:5432/analyst_awards
REDIS_URL=redis://localhost:6379/0
```

### 프로덕션 환경

```bash
# 프론트엔드
NEXT_PUBLIC_API_URL=https://api.yourdomain.com

# 백엔드
DATABASE_URL=postgresql://user:password@db.yourdomain.com:5432/analyst_awards
REDIS_URL=redis://redis.yourdomain.com:6379/0
CORS_ORIGINS=https://yourdomain.com
```

## 문제 해결

### 프론트엔드에서 API 호출 실패

1. **환경변수 확인**: `NEXT_PUBLIC_API_URL`이 올바르게 설정되었는지 확인
2. **서버 재시작**: 환경변수 변경 후 Next.js 개발 서버 재시작
3. **브라우저 콘솔 확인**: 네트워크 에러 메시지 확인

### 백엔드 연결 실패

1. **데이터베이스 확인**: PostgreSQL 서비스 실행 확인
2. **Redis 확인**: Redis 서비스 실행 확인
3. **포트 확인**: 백엔드가 8000 포트에서 실행 중인지 확인

## 보안 주의사항

1. **API 키 보호**: `.env` 파일은 절대 Git에 커밋하지 마세요
2. **.gitignore 확인**: `.env`, `.env.local` 파일이 `.gitignore`에 포함되어 있는지 확인
3. **프로덕션 키**: 프로덕션 환경에서는 강력한 비밀번호와 API 키 사용

