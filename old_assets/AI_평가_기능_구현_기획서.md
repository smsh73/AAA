# AI 평가 기능 구현 기획서

## 1. 개요

본 문서는 "AI가 찾은 스타 애널리스트" 어워즈를 위한 AI 평가 시스템 구현 기획서입니다. 각 평가 항목별로 AI 서비스(OpenAI, Claude, Gemini, Perplexity)를 활용하여 평가를 수행하고, 평가 점수를 취합하여 최종 Award를 선정하는 시스템을 구축합니다.

## 2. 평가 항목 및 가중치

### 2.1 전체 평가 항목 구조

| 평가 항목 | 가중치 | AI 담당 서비스 | 평가 방식 |
|---------|--------|--------------|----------|
| 1. 목표주가 정확성 | 25% | Gemini Agent | 수식 기반 계산 |
| 2. 실적 추정 정확성 | 30% | Gemini Agent | 가중 평균 오차율 계산 |
| 3. 투자 논리의 타당성 | 15% | Claude Agent | 텍스트 분석 및 평가 |
| 4. 위험 요소 분석 적절성 | 10% | Claude Agent | 텍스트 분석 및 평가 |
| 5. 투자 리포트 발간 빈도 | 5% | OpenAI Agent | 데이터 집계 및 계산 |
| 6. SNS 주목도 평가 | 10% | Perplexity Agent | SNS 데이터 수집 및 분석 |
| 7. 언론 빈도 평가 | 5% | Perplexity Agent | 언론 데이터 수집 및 분석 |

**총 가중치 합계**: 100%

## 3. 평가 항목별 상세 구현

### 3.1 목표주가 정확성 (25%)

#### 3.1.1 평가 목적
애널리스트가 설정한 목표주가와 실제 주가의 괴리율을 계산하여 예측 정확도를 측정

#### 3.1.2 담당 AI 서비스
- **Gemini Agent**: 주가 데이터 수집 및 괴리율 계산

#### 3.1.3 계산 수식

```
괴리율(%) = (기간 별 실제 주가 - 목표 주가) / 목표주가 × 100

정확도 점수 = 100 - min(|괴리율|, 100)
```

**설명**:
- 괴리율의 절댓값이 0에 가까울수록 정확한 예측
- 괴리율이 음수: 실제 주가가 목표주가보다 낮음
- 괴리율이 양수: 실제 주가가 목표주가보다 높음
- 정확도 점수는 0~100점 척도

#### 3.1.4 구현 절차

1. **데이터 수집 (Gemini Agent)**
   - 리포트에서 목표주가 추출 (OpenAI Agent가 이미 수행)
   - 예측 기간 설정 (예: 3개월, 6개월, 1년)
   - 해당 기간 종료 시점의 실제 주가 수집

2. **괴리율 계산 (Gemini Agent)**
   - 각 목표주가별 괴리율 계산
   - 여러 목표주가가 있는 경우 평균 괴리율 계산

3. **점수 산출**
   - 괴리율 절댓값을 기반으로 정확도 점수 계산
   - 최종 점수 = 100 - min(|괴리율|, 100)

#### 3.1.5 예시

```
목표주가: 50,000원
실제 주가: 48,000원
괴리율: (48,000 - 50,000) / 50,000 × 100 = -4%
절댓값: 4%
정확도 점수: 100 - 4 = 96점
```

### 3.2 실적 추정 정확성 (30%) - 최고 가중치 항목

#### 3.2.1 평가 목적
애널리스트가 예측한 실적(매출액, 영업이익, 순이익)과 실제 발표된 실적의 가중 평균 오차율을 계산

#### 3.2.2 담당 AI 서비스
- **Gemini Agent**: 실적 데이터 수집 및 가중 평균 오차율 계산

#### 3.2.3 평가 대상
- **기간**: 2025년 1Q, 2Q, 3Q (3개 분기)
- **재무 지표**: 매출액, 영업이익, 순이익 (3개 지표)
- **총 평가 항목**: 3 × 3 = 9개 항목

#### 3.2.4 가중 평균 오차율 계산 수식 (3단계)

##### 3.2.4.1 1단계: 개별 예측 오차율(E) 계산

```
E = |A - F| / |A|

변수 정의:
- A: 실제 발표된 실적 (Actual)
- F: 애널리스트가 예측한 실적 (Forecast)
- E: 개별 예측 오차율 (Error Rate)
- | |: 절댓값 기호
```

**9개 항목별 오차율 계산**:
- E_1: 1분기 매출액 오차율
- E_2: 1분기 영업이익 오차율
- E_3: 1분기 순이익 오차율
- E_4: 2분기 매출액 오차율
- E_5: 2분기 영업이익 오차율
- E_6: 2분기 순이익 오차율
- E_7: 3분기 매출액 오차율
- E_8: 3분기 영업이익 오차율
- E_9: 3분기 순이익 오차율

##### 3.2.4.2 2단계: 가중치(W) 설정

**기간별 가중치**:
- 1분기: 20% (0.20) - 가까운 미래에 더 높은 가중치
- 2분기: 30% (0.30)
- 3분기: 50% (0.50) - 먼 미래에 더 높은 가중치

**재무 지표별 가중치**:
- 영업이익: 60% (0.60) - 핵심 사업 능력
- 매출액: 20% (0.20)
- 순이익: 20% (0.20)

**최종 가중치 계산**:
```
W_1Q_매출액 = 0.20 × 0.20 = 0.04
W_1Q_영업이익 = 0.20 × 0.60 = 0.12
W_1Q_순이익 = 0.20 × 0.20 = 0.04

W_2Q_매출액 = 0.30 × 0.20 = 0.06
W_2Q_영업이익 = 0.30 × 0.60 = 0.18
W_2Q_순이익 = 0.30 × 0.20 = 0.06

W_3Q_매출액 = 0.50 × 0.20 = 0.10
W_3Q_영업이익 = 0.50 × 0.60 = 0.30
W_3Q_순이익 = 0.50 × 0.20 = 0.10

검증: 모든 가중치 합계 = 1.00 (100%)
```

##### 3.2.4.3 3단계: 최종 가중 평균 오차율 계산

```
가중 평균 오차율 = (E₁ × W₁) + (E₂ × W₂) + ... + (E₉ × W₉)

또는 수학 기호로:
가중 평균 오차율 = Σ(i=1 to 9) (Eᵢ × Wᵢ)
```

##### 3.2.4.4 정확도 점수 산출

```
정확도 점수 = 100 - (가중 평균 오차율 × 100)

단, 정확도 점수는 0 이상 100 이하로 제한
```

#### 3.2.5 구현 절차

1. **데이터 수집 (Gemini Agent)**
   - 리포트에서 실적 예측 추출 (OpenAI Agent가 이미 수행)
   - DART 공시 시스템에서 실제 실적 데이터 수집
   - 9개 항목별 예측값과 실제값 매칭

2. **개별 오차율 계산 (Gemini Agent)**
   - 각 항목별로 E = |A - F| / |A| 계산

3. **가중치 적용 및 최종 계산 (Gemini Agent)**
   - 가중 평균 오차율 계산
   - 정확도 점수 산출

#### 3.2.6 예시 계산

```
예측값과 실제값:
1분기 매출액: 예측 1000억, 실제 950억 → E = |950-1000|/950 = 0.0526
1분기 영업이익: 예측 500억, 실제 480억 → E = |480-500|/480 = 0.0417
...

가중 평균 오차율:
= (0.0526 × 0.04) + (0.0417 × 0.12) + ... + (E₉ × W₉)
= 0.035 (예시)

정확도 점수:
= 100 - (0.035 × 100) = 96.5점
```

### 3.3 투자 논리의 타당성 (15%)

#### 3.3.1 평가 목적
리포트에서 제시한 투자 포인트의 논리적 타당성, 근거의 충실도, 시장 상황 반영 여부를 평가

#### 3.3.2 담당 AI 서비스
- **Claude Agent**: 리포트 텍스트 분석 및 투자 논리 평가

#### 3.3.3 평가 기준

1. **논리적 일관성 (40%)**
   - 투자 포인트와 근거의 논리적 연결성
   - 데이터와 결론의 일관성
   - 모순 없는 논리 전개

2. **근거의 충실도 (30%)**
   - 구체적인 데이터 제시
   - 외부 참고 자료 인용
   - 정량적 근거의 질

3. **시장 상황 반영 (30%)**
   - 현재 시장 환경 고려
   - 산업 트렌드 반영
   - 경쟁사 상황 분석

#### 3.3.4 구현 절차

1. **텍스트 추출 (OpenAI Agent)**
   - 리포트에서 투자 포인트 및 근거 문단 추출

2. **논리 분석 (Claude Agent)**
   - Claude Agent에 투자 논리 텍스트 전달
   - 각 평가 기준별 점수 산출 (0-100점)

3. **최종 점수 계산**
   ```
   최종 점수 = (논리적 일관성 × 0.4) + (근거의 충실도 × 0.3) + (시장 상황 반영 × 0.3)
   ```

#### 3.3.5 Claude Agent Prompt 예시

```
다음 애널리스트 리포트의 투자 논리를 평가하세요:

[투자 포인트 및 근거 텍스트]

평가 기준:
1. 논리적 일관성 (40%): 투자 포인트와 근거의 논리적 연결성
2. 근거의 충실도 (30%): 구체적인 데이터 제시 여부
3. 시장 상황 반영 (30%): 현재 시장 환경 고려 여부

각 기준별로 0-100점 척도로 점수를 매기고, 최종 점수를 계산하세요.
출력 형식: JSON
```

### 3.4 위험 요소 분석 적절성 (10%)

#### 3.4.1 평가 목적
종목의 위험을 얼마나 구체적이고 합리적으로 제시했는지 평가

#### 3.4.2 담당 AI 서비스
- **Claude Agent**: 리포트 텍스트 분석 및 위험 요소 평가

#### 3.4.3 평가 기준

1. **위험 요소 식별의 구체성 (40%)**
   - 구체적인 위험 요소 명시
   - 위험 요소의 정량적 제시
   - 위험 시나리오 구체화

2. **위험 분석의 합리성 (35%)**
   - 위험 요소의 발생 가능성 평가
   - 위험의 영향도 분석
   - 위험 대응 방안 제시

3. **위험 요소의 포괄성 (25%)**
   - 다양한 위험 요소 고려
   - 숨겨진 위험 요소 발견
   - 전반적인 위험 인식

#### 3.4.4 구현 절차

1. **텍스트 추출 (OpenAI Agent)**
   - 리포트에서 위험 요소 분석 섹션 추출

2. **위험 분석 평가 (Claude Agent)**
   - Claude Agent에 위험 분석 텍스트 전달
   - 각 평가 기준별 점수 산출

3. **최종 점수 계산**
   ```
   최종 점수 = (구체성 × 0.4) + (합리성 × 0.35) + (포괄성 × 0.25)
   ```

### 3.5 투자 리포트 발간 빈도 (5%)

#### 3.5.1 평가 목적
애널리스트의 보고서 발간 빈도와 일관성을 평가

#### 3.5.2 담당 AI 서비스
- **OpenAI Agent**: 보고서 데이터 집계 및 빈도 계산

#### 3.5.3 평가 기준

1. **발간 빈도 (60%)**
   - 월별 평균 발간 횟수
   - 기준: 월 4회 이상 = 100점, 월 2회 = 50점, 월 1회 = 25점

2. **발간 일관성 (40%)**
   - 정기적 발간 여부
   - 발간 간격의 일관성
   - 계절성 요인 고려

#### 3.5.4 구현 절차

1. **데이터 수집 (OpenAI Agent)**
   - 애널리스트의 과거 보고서 목록 수집
   - 발간 날짜 추출

2. **빈도 계산 (OpenAI Agent)**
   - 평가 기간 내 발간 횟수 계산
   - 월별 평균 발간 횟수 산출
   - 발간 일관성 측정

3. **점수 산출**
   ```
   발간 빈도 점수 = min((월평균 발간 횟수 / 4) × 100, 100)
   일관성 점수 = (발간 일관성 지표) × 100
   
   최종 점수 = (발간 빈도 점수 × 0.6) + (일관성 점수 × 0.4)
   ```

### 3.6 SNS 주목도 평가 (10%)

#### 3.6.1 평가 목적
SNS에서 리포트나 애널리스트가 회자되는 빈도수를 평가

#### 3.6.2 담당 AI 서비스
- **Perplexity Agent**: SNS 데이터 수집 및 분석

#### 3.6.3 평가 기준

1. **SNS 언급량 (50%)**
   - X(Twitter), 블로그, 인스타그램 등 언급 횟수
   - 리포트 제목, 애널리스트명 언급 횟수

2. **바이럴 지수 (30%)**
   - 공유 및 재게시 횟수
   - 확산 속도

3. **영향력 있는 계정 언급 (20%)**
   - 팔로워 수가 많은 계정의 언급
   - 전문가 계정의 언급

#### 3.6.4 구현 절차

1. **데이터 수집 (Perplexity Agent)**
   - 리포트 발간 후 SNS 언급 수집
   - X(Twitter) API, 블로그 크롤링 등

2. **분석 및 점수 산출 (Perplexity Agent)**
   - 언급량 정규화 및 점수화
   - 바이럴 지수 계산
   - 영향력 있는 계정 언급 여부 확인

3. **최종 점수 계산**
   ```
   최종 점수 = (SNS 언급량 점수 × 0.5) + (바이럴 지수 점수 × 0.3) + (영향력 점수 × 0.2)
   ```

### 3.7 언론 빈도 평가 (5%)

#### 3.7.1 평가 목적
언론에서 리포트나 애널리스트의 언급 빈도를 평가

#### 3.7.2 담당 AI 서비스
- **Perplexity Agent**: 언론 데이터 수집 및 분석

#### 3.7.3 평가 기준

1. **언론 언급 횟수 (70%)**
   - 주요 언론사 기사 내 언급 횟수
   - 리포트 인용 횟수

2. **언론 영향력 (30%)**
   - 주요 언론사 언급 여부
   - 1면 기사 여부

#### 3.7.4 구현 절차

1. **데이터 수집 (Perplexity Agent)**
   - 주요 언론사 기사 크롤링
   - 리포트 제목, 애널리스트명 검색

2. **분석 및 점수 산출 (Perplexity Agent)**
   - 언급 횟수 정규화
   - 언론사 영향력 가중치 적용

3. **최종 점수 계산**
   ```
   최종 점수 = (언급 횟수 점수 × 0.7) + (언론 영향력 점수 × 0.3)
   ```

## 4. AI 서비스별 역할 분담

### 4.1 OpenAI Agent (GPT-4)

**담당 평가 항목**:
- 투자 리포트 발간 빈도 (5%)

**주요 역할**:
1. 보고서 파싱 및 메타데이터 추출
2. 발간 날짜 추출 및 집계
3. 발간 빈도 계산

### 4.2 Claude Agent (Claude 3.5 Sonnet)

**담당 평가 항목**:
- 투자 논리의 타당성 (15%)
- 위험 요소 분석 적절성 (10%)

**주요 역할**:
1. 리포트 텍스트 분석
2. 논리적 일관성 평가
3. 근거 충실도 평가
4. 위험 요소 분석 평가

### 4.3 Gemini Agent (Gemini Pro)

**담당 평가 항목**:
- 목표주가 정확성 (25%)
- 실적 추정 정확성 (30%)

**주요 역할**:
1. 주가 데이터 수집 및 계산
2. 실적 데이터 수집
3. 괴리율 계산
4. 가중 평균 오차율 계산

### 4.4 Perplexity Agent

**담당 평가 항목**:
- SNS 주목도 평가 (10%)
- 언론 빈도 평가 (5%)

**주요 역할**:
1. SNS 데이터 수집
2. 언론 기사 수집
3. 바이럴 지수 계산
4. 언급 빈도 분석

## 5. 평가 프로세스 통합

### 5.1 전체 평가 프로세스

```
1. 보고서 업로드 및 파싱
   │
   ├─> OpenAI Agent: 보고서 파싱 및 메타데이터 추출
   │
2. 1단계: AI 정량 분석 (40% 가중치)
   │
   ├─> Gemini Agent: 목표주가 정확성 평가 (25%)
   │   └─> 괴리율 계산 및 점수 산출
   │
   ├─> Gemini Agent: 실적 추정 정확성 평가 (30%)
   │   └─> 가중 평균 오차율 계산 및 점수 산출
   │
   ├─> OpenAI Agent: 리포트 발간 빈도 평가 (5%)
   │   └─> 빈도 계산 및 점수 산출
   │
   ├─> Claude Agent: 투자 논리 타당성 평가 (15%)
   │   └─> 텍스트 분석 및 점수 산출
   │
   └─> Claude Agent: 위험 요소 분석 적절성 평가 (10%)
       └─> 텍스트 분석 및 점수 산출

3. 2단계: SNS·시장 반응 분석 (30% 가중치)
   │
   ├─> Perplexity Agent: SNS 주목도 평가 (10%)
   │   └─> SNS 데이터 수집 및 분석
   │
   └─> Perplexity Agent: 언론 빈도 평가 (5%)
       └─> 언론 데이터 수집 및 분석

4. 3단계: 전문가 평가 및 설문 (30% 가중치)
   │
   ├─> 운용사/리서치센터 설문
   └─> 리테일 투자자 설문

5. 최종 점수 계산 및 Award 선정
   │
   └─> 3단계 통합 점수 계산
       └─> Award 선정
```

### 5.2 최종 점수 계산

```
최종 점수 = (AI 정량 분석 점수 × 0.40) 
          + (SNS·시장 반응 점수 × 0.30) 
          + (전문가 평가 및 설문 점수 × 0.30)

AI 정량 분석 점수 = (목표주가 정확성 × 0.25) 
                   + (실적 추정 정확성 × 0.30)
                   + (투자 논리 타당성 × 0.15)
                   + (위험 요소 분석 적절성 × 0.10)
                   + (리포트 발간 빈도 × 0.05)
                   + (SNS 주목도 × 0.10)
                   + (언론 빈도 × 0.05)

SNS·시장 반응 점수 = (SNS 주목도 × 0.5) + (언론 빈도 × 0.5)
```

## 6. 구현 세부사항

### 6.1 데이터 구조

#### 6.1.1 평가 결과 데이터 구조

```json
{
  "report_id": "report_123",
  "analyst_id": "analyst_456",
  "evaluation_date": "2025-01-16",
  "scores": {
    "target_price_accuracy": {
      "score": 96.0,
      "weight": 0.25,
      "details": {
        "target_price": 50000,
        "actual_price": 48000,
        "deviation_rate": -4.0
      }
    },
    "performance_accuracy": {
      "score": 96.5,
      "weight": 0.30,
      "details": {
        "weighted_average_error_rate": 0.035,
        "individual_errors": [
          {"period": "1Q", "metric": "매출액", "error": 0.0526, "weight": 0.04},
          ...
        ]
      }
    },
    "investment_logic_validity": {
      "score": 85.0,
      "weight": 0.15,
      "details": {
        "logical_consistency": 90,
        "evidence_support": 80,
        "market_reflection": 85
      }
    },
    "risk_analysis_adequacy": {
      "score": 80.0,
      "weight": 0.10,
      "details": {
        "specificity": 85,
        "rationality": 75,
        "comprehensiveness": 80
      }
    },
    "report_frequency": {
      "score": 75.0,
      "weight": 0.05,
      "details": {
        "monthly_average": 3,
        "consistency_score": 80
      }
    },
    "sns_attention": {
      "score": 70.0,
      "weight": 0.10,
      "details": {
        "mention_count": 150,
        "viral_index": 65,
        "influencer_mentions": 75
      }
    },
    "media_frequency": {
      "score": 65.0,
      "weight": 0.05,
      "details": {
        "mention_count": 25,
        "influence_score": 60
      }
    }
  },
  "final_score": 85.5,
  "ai_quantitative_score": 88.2,
  "sns_market_score": 67.5,
  "expert_survey_score": 82.0
}
```

### 6.2 API 엔드포인트 설계

#### 6.2.1 평가 시작 API

```
POST /api/evaluations/start
```

**Request**:
```json
{
  "report_id": "report_123",
  "analyst_id": "analyst_456"
}
```

**Response**:
```json
{
  "evaluation_id": "eval_789",
  "status": "processing",
  "estimated_completion_time": "2025-01-16T12:00:00Z"
}
```

#### 6.2.2 평가 결과 조회 API

```
GET /api/evaluations/{evaluation_id}
```

**Response**:
```json
{
  "evaluation_id": "eval_789",
  "status": "completed",
  "scores": {...},
  "final_score": 85.5
}
```

### 6.3 에러 처리

#### 6.3.1 AI 서비스 실패 시 처리
- 각 AI 서비스별 재시도 로직 (최대 3회)
- 부분 실패 시에도 다른 항목 평가는 진행
- 실패한 항목은 0점 처리 또는 수동 검증 플래그

#### 6.3.2 데이터 부족 시 처리
- 실제 데이터가 없는 경우 (예: 아직 발표되지 않은 실적)
- 해당 항목은 평가 제외 또는 보류
- 평가 가능한 항목만으로 점수 계산

## 7. 개발 우선순위

### Phase 1: 핵심 평가 항목 (1-2주)
1. 목표주가 정확성 (Gemini Agent)
2. 실적 추정 정확성 (Gemini Agent) - 최고 가중치
3. 투자 논리 타당성 (Claude Agent)

### Phase 2: 추가 평가 항목 (1주)
4. 위험 요소 분석 적절성 (Claude Agent)
5. 리포트 발간 빈도 (OpenAI Agent)

### Phase 3: 외부 데이터 수집 (1-2주)
6. SNS 주목도 평가 (Perplexity Agent)
7. 언론 빈도 평가 (Perplexity Agent)

### Phase 4: 통합 및 최적화 (1주)
8. 전체 평가 프로세스 통합
9. 점수 계산 및 Award 선정 로직
10. 성능 최적화 및 테스트

## 8. 테스트 시나리오

### 8.1 단위 테스트
- 각 평가 항목별 계산 로직 테스트
- 가중 평균 오차율 계산 정확도 검증
- 괴리율 계산 정확도 검증

### 8.2 통합 테스트
- 전체 평가 프로세스 통합 테스트
- AI 서비스 호출 및 응답 처리 테스트
- 에러 처리 시나리오 테스트

### 8.3 샘플 데이터 테스트
- 실제 애널리스트 리포트 샘플로 평가 수행
- 평가 결과의 합리성 검증
- 점수 분포 확인

## 9. 참고사항

### 9.1 가중치 조정
- 초기 가중치는 이 문서에 명시된 값을 사용
- 실제 운영 후 데이터 분석 결과에 따라 가중치 조정 가능

### 9.2 평가 기준 명확화
- 각 평가 항목의 평가 기준은 실제 운영 시 더 구체화 필요
- 평가자 간 일관성을 위한 평가 가이드라인 작성 권장

### 9.3 데이터 품질 관리
- 수집된 데이터의 품질 검증 필요
- 데이터 출처의 신뢰성 확인
- 이상치 탐지 및 처리




