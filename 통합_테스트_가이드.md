# 통합 테스트 가이드

## 환경 설정

### 1. 환경 변수 설정

프로젝트 루트에 `.env` 파일 생성:

```bash
# Backend API URL (프론트엔드용)
NEXT_PUBLIC_API_URL=http://localhost:8000

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/analyst_awards

# Redis
REDIS_URL=redis://localhost:6379/0
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2

# AI API Keys
OPENAI_API_KEY=your_openai_key_here
ANTHROPIC_API_KEY=your_anthropic_key_here
GOOGLE_API_KEY=your_google_key_here
PERPLEXITY_API_KEY=your_perplexity_key_here

# CORS
CORS_ORIGINS=http://localhost:3000,http://localhost:5000

# Storage
STORAGE_PATH=/app/storage
```

### 2. 데이터베이스 초기화

```bash
cd apps/api
alembic upgrade head
```

### 3. 서비스 시작

#### 백엔드 (터미널 1)
```bash
cd apps/api
uvicorn app.main:app --reload --port 8000
```

#### Celery Worker (터미널 2)
```bash
cd apps/api
celery -A app.celery_app worker --loglevel=info
```

#### 프론트엔드 (터미널 3)
```bash
cd apps/web
npm install
npm run dev
```

## API 테스트 체크리스트

### 1. Health Check
- [ ] `GET /api/health` - 정상 응답 확인

### 2. Dashboard
- [ ] `GET /api/dashboard/stats` - 통계 데이터 확인
- [ ] `GET /api/dashboard/recent-evaluations` - 최근 평가 목록 확인
- [ ] `GET /api/dashboard/award-status` - 어워드 현황 확인

### 3. Analysts
- [ ] `GET /api/analysts` - 목록 조회
- [ ] `GET /api/analysts/{id}` - 상세 조회
- [ ] `POST /api/analysts` - 생성
- [ ] `POST /api/analysts/bulk-import` - 일괄 등록

### 4. Reports
- [ ] `GET /api/reports` - 목록 조회
- [ ] `GET /api/reports/{id}` - 상세 조회
- [ ] `POST /api/reports/upload` - 업로드
- [ ] `GET /api/reports/{id}/predictions` - 예측 정보 조회

### 5. Evaluations
- [ ] `GET /api/evaluations` - 목록 조회
- [ ] `GET /api/evaluations/{id}` - 상세 조회
- [ ] `GET /api/evaluations/{id}/scores` - 점수 조회
- [ ] `POST /api/evaluations/start` - 평가 시작

### 6. Scorecards
- [ ] `GET /api/scorecards` - 목록 조회
- [ ] `GET /api/scorecards/{id}` - 상세 조회
- [ ] `GET /api/scorecards/ranking` - 랭킹 조회

### 7. Awards
- [ ] `GET /api/awards?year=2025` - 어워드 조회
- [ ] `POST /api/awards/run` - 어워드 선정 실행

### 8. Data Collection
- [ ] `POST /api/data-collection/start` - 수집 시작
- [ ] `GET /api/data-collection/{job_id}/status` - 상태 조회
- [ ] `GET /api/data-collection/logs` - 로그 조회

## 프론트엔드 테스트 체크리스트

### 1. 대시보드
- [ ] 페이지 로드 확인
- [ ] 통계 카드 표시 확인
- [ ] 차트 표시 확인

### 2. 애널리스트
- [ ] 목록 페이지 로드
- [ ] 상세 페이지 로드
- [ ] 필터링 기능

### 3. 리포트
- [ ] 목록 페이지 로드
- [ ] 업로드 기능
- [ ] 상세 페이지 로드
- [ ] 예측 정보 표시

### 4. 평가
- [ ] 목록 페이지 로드
- [ ] 평가 시작 기능
- [ ] 상세 페이지 로드
- [ ] 점수 표시

### 5. 스코어카드
- [ ] 목록 페이지 로드
- [ ] 상세 페이지 로드
- [ ] 랭킹 페이지 로드

### 6. 어워드
- [ ] 목록 페이지 로드
- [ ] 어워드 선정 기능

### 7. 데이터 수집
- [ ] 수집 시작 폼
- [ ] 진행 중인 작업 표시
- [ ] 로그 목록 표시

## 테스트 스크립트

### API 테스트 (curl)

```bash
# Health Check
curl http://localhost:8000/api/health

# Dashboard Stats
curl http://localhost:8000/api/dashboard/stats

# Analysts
curl http://localhost:8000/api/analysts

# Reports
curl http://localhost:8000/api/reports

# Evaluations
curl http://localhost:8000/api/evaluations

# Scorecards
curl http://localhost:8000/api/scorecards

# Awards
curl "http://localhost:8000/api/awards?year=2025"

# Data Collection Logs
curl http://localhost:8000/api/data-collection/logs
```

## 문제 해결

### API 연결 실패
1. 백엔드 서버가 실행 중인지 확인
2. `NEXT_PUBLIC_API_URL` 환경변수 확인
3. CORS 설정 확인

### 데이터베이스 연결 실패
1. PostgreSQL 서비스 실행 확인
2. `DATABASE_URL` 환경변수 확인
3. 마이그레이션 실행 확인

### Celery 작업 실패
1. Redis 서비스 실행 확인
2. Celery Worker 실행 확인
3. 작업 로그 확인

